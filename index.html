<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario de Solicitudes - Az InnovationX</title>
  <style>
    /* --- Estilos Generales y Dependencias --- */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.7;
      color: #ffffff;
      background-image: url('https://i.ibb.co/84ffsSxc/Power-BI-gif-header.gif');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      overflow-x: hidden;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      position: relative;
    }

    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.6);
      z-index: 0;
    }

    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* --- Estilos de la Sección y Título --- */
    section {
      padding: 6rem 0;
      position: relative;
    }

    #solicitudes {
      border-radius: 24px;
      overflow: hidden;
    }

    .section-title {
      text-align: center;
      font-size: clamp(2rem, 4vw, 2.75rem);
      margin-bottom: 3rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      background: linear-gradient(90deg, #FFD700, #ffffff, #FF6B35, #ffffff, #FFD700);
      background-size: 400% 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 3; /* Asegura que el título esté por encima del fondo ambiental */
      animation: title-shimmer 8s linear infinite;
    }

    @keyframes title-shimmer {
      from { background-position: 0% 0%; }
      to { background-position: -200% 0%; }
    }

    /* --- Efectos Visuales de la Sección de Solicitudes --- */
    .solicitudes-ambient-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), rgba(255, 107, 53, 0.15), transparent 40%);
      z-index: 1;
      transition: background 0.2s ease-out;
    }

    .form-frame {
      position: absolute;
      top: -15px;
      left: -15px;
      right: -15px;
      bottom: -15px;
      border: 2px solid rgba(255, 107, 53, 0.4);
      border-radius: 25px;
      pointer-events: none;
      animation: pulse-border-dm 5s ease-in-out infinite;
    }

    @keyframes pulse-border-dm {
      0%, 100% {
        border-color: rgba(255, 107, 53, 0.4);
        box-shadow: 0 0 25px rgba(255, 107, 53, 0.2);
      }
      50% {
        border-color: rgba(255, 107, 53, 0.7);
        box-shadow: 0 0 35px rgba(255, 107, 53, 0.4);
      }
    }

    /* --- Estilos del Formulario de Contacto --- */
    .contact-form {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
      backdrop-filter: blur(25px);
      -webkit-backdrop-filter: blur(25px);
      border-radius: 24px;
      padding: 3rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      max-width: 800px; /* Ancho máximo para el formulario */
      width: 100%;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: #FF6B35;
      font-weight: 500;
      font-size: 0.9rem;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      color: white;
      font-size: 1rem;
      transition: all 0.3s ease;
      -webkit-appearance: none;
      appearance: none;
    }

    .form-group select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%23ffffff' d='M6 8L0 2h12z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      padding-right: 40px;
    }
    
    .form-group select option {
        background: #1a1a2e;
        color: white;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: rgba(255, 107, 53, 0.8);
      box-shadow: 0 0 0 4px rgba(255, 107, 53, 0.2);
    }

    .form-group input::placeholder,
    .form-group textarea::placeholder {
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.9rem;
    }

    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }

    /* --- Estilos del Botón de Envío y Mensajes --- */
    .submit-btn {
      width: 100%;
      padding: 1rem 2rem;
      background: linear-gradient(45deg, #FF6B35, #F7931E);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .submit-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(255, 107, 53, 0.4);
    }

    .submit-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    .success-message,
    .error-message {
      display: none;
      padding: 16px;
      border-radius: 12px;
      margin-top: 1.2rem;
      text-align: center;
      animation: slideIn 0.5s ease;
      font-weight: 500;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      font-size: 0.9rem;
    }
    
    .success-message {
      background: rgba(34, 197, 94, 0.15);
      border: 1px solid rgba(34, 197, 94, 0.4);
      color: #22c55e;
    }

    .error-message {
      background: rgba(239, 68, 68, 0.15);
      border: 1px solid rgba(239, 68, 68, 0.4);
      color: #ef4444;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* --- Estilos de Loading y Validación --- */
    .loading {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #ffffff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .form-group input.valid,
    .form-group select.valid,
    .form-group textarea.valid {
      border-color: #22c55e;
    }

    .form-group input.invalid,
    .form-group select.invalid,
    .form-group textarea.invalid {
      border-color: #ef4444;
    }

    /* --- Responsive Design --- */
    @media (max-width: 768px) {
      body {
        padding: 1rem;
        align-items: flex-start; /* Para mejor visualización en móviles */
      }
      
      .container {
        padding: 0 1rem;
      }
      
      .section-title {
        font-size: clamp(1.8rem, 5vw, 2.2rem);
      }
      
      .contact-form {
        padding: 1.5rem;
      }
    }
  </style>
</head>
<body>

  <section id="solicitudes">
    <div class="solicitudes-ambient-bg"></div>
    <div class="container" style="position: relative; z-index: 2;">
      <div class="form-frame"></div>
      <h2 class="section-title">Solicitudes</h2>
      <form class="contact-form" id="contactForm">
        <div class="form-group">
          <label for="nombre">Nombre Completo *</label>
          <input type="text" id="nombre" name="nombre" required>
        </div>
        <div class="form-group">
          <label for="email">Correo Electrónico *</label>
          <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
          <label for="telefono">Teléfono</label>
          <input type="tel" id="telefono" name="telefono">
        </div>
        <div class="form-group">
          <label for="empresa">Empresa/Organización</label>
          <input type="text" id="empresa" name="empresa">
        </div>
        <div class="form-group">
          <label for="servicio">Servicio de Interés *</label>
          <select id="servicio" name="servicio" required>
            <option value="">Selecciona un servicio</option>
            <option value="aplicaciones-android">Desarrollo de Aplicaciones Android</option>
            <option value="paginas-web">Páginas Web</option>
            <option value="tiendas-online">Tiendas Online</option>
            <option value="chatbots">Chatbots Inteligentes</option>
            <option value="seguridad">Consultoría en Seguridad Informática</option>
            <option value="multiple">Múltiples Servicios</option>
            <option value="otro">Otro</option>
          </select>
        </div>
        <div class="form-group">
          <label for="presupuesto">Presupuesto Estimado</label>
          <select id="presupuesto" name="presupuesto">
            <option value="">Selecciona un rango</option>
            <option value="menos-2000">Menos de $2,000 MXN</option>
            <option value="2000-4000">$2,000 - $4,000 MXN</option>
            <option value="4000-6000">$4,000 - $6,000 MXN</option>
            <option value="6000-10000">$6,000 - $10,000 MXN</option>
            <option value="10000-14000">$10,000 - $14,000 MXN</option>
            <option value="14000-18000">$14,000 - $18,000 MXN</option>
          </select>
        </div>
        <div class="form-group">
          <label for="mensaje">Cuéntanos sobre tu proyecto *</label>
          <textarea id="mensaje" name="mensaje" placeholder="Describe tu idea, objetivos, funcionalidades deseadas, timeline, etc. Mientras más detalles compartas, mejor podremos ayudarte." required></textarea>
        </div>
        <button type="submit" class="submit-btn" id="submitBtn">Enviar Solicitud</button>
        <div class="success-message" id="successMessage">
          ¡Gracias por contactarnos! Hemos recibido tu mensaje y nos pondremos en contacto contigo en las próximas 24 horas.
        </div>
        <div class="error-message" id="errorMessage">
          Hubo un error al enviar el formulario. Por favor, inténtalo de nuevo.
        </div>
      </form>
    </div>
  </section>

  <!-- Firebase and Form Submission Script -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script>
    // --- Lógica de Interacción del Formulario ---
    document.addEventListener('DOMContentLoaded', () => {
        // --- Efecto ambiental del mouse ---
        const solicitudesSection = document.querySelector('#solicitudes');
        const ambientBg = document.querySelector('.solicitudes-ambient-bg');
        if (solicitudesSection && ambientBg) {
            solicitudesSection.addEventListener('mousemove', (e) => {
                const rect = solicitudesSection.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                ambientBg.style.setProperty('--mouse-x', `${(x / rect.width) * 100}%`);
                ambientBg.style.setProperty('--mouse-y', `${(y / rect.height) * 100}%`);
            });
        }
        
        // --- Conexión y Lógica de Firebase ---
        const firebaseConfig = {
            apiKey: "AIzaSyDyk6XjQ72k73oza9fkkUxup9GQvDsFT5o",
            authDomain: "weatherwise-aywzg.firebaseapp.com",
            projectId: "weatherwise-aywzg",
            storageBucket: "weatherwise-aywzg.firebasestorage.app",
            messagingSenderId: "699516071771",
            appId: "1:699516071771:web:5a84dcf771b1ee5c38b47e"
        };
        
        let db;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            console.log('Firebase inicializado correctamente.');
        } catch (error) {
            console.error('Error al inicializar Firebase:', error);
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = 'Error de conexión. No se pudo inicializar la base de datos.';
            errorMessage.style.display = 'block';
        }

        // --- Validación del Formulario ---
        function validateForm() {
            const requiredFields = ['nombre', 'email', 'servicio', 'mensaje'];
            let isValid = true;
            requiredFields.forEach(fieldName => {
                const field = document.getElementById(fieldName);
                const value = field.value.trim();
                if (!value) {
                    field.classList.add('invalid');
                    field.classList.remove('valid');
                    isValid = false;
                } else {
                    field.classList.remove('invalid');
                    field.classList.add('valid');
                }
            });

            const emailField = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (emailField.value && !emailRegex.test(emailField.value)) {
                emailField.classList.add('invalid');
                emailField.classList.remove('valid');
                isValid = false;
            }
            return isValid;
        }

        // --- Validación en tiempo real ---
        document.querySelectorAll('input[required], select[required], textarea[required]').forEach(field => {
            field.addEventListener('blur', function () {
                const value = this.value.trim();
                if (value) {
                    this.classList.remove('invalid');
                    this.classList.add('valid');
                } else {
                    this.classList.add('invalid');
                    this.classList.remove('valid');
                }
            });
            field.addEventListener('input', function () {
                if (this.classList.contains('invalid') && this.value.trim()) {
                    this.classList.remove('invalid');
                    this.classList.add('valid');
                }
            });
        });

        // --- Envío del Formulario ---
        document.getElementById('contactForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const submitBtn = document.getElementById('submitBtn');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');

            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            if (!validateForm()) {
                errorMessage.textContent = 'Por favor, completa todos los campos obligatorios correctamente.';
                errorMessage.style.display = 'block';
                return;
            }
            
            if (!db) {
                errorMessage.textContent = 'La base de datos no está disponible. Inténtalo más tarde.';
                errorMessage.style.display = 'block';
                return;
            }

            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="loading"></span>Enviando...';
            submitBtn.disabled = true;

            try {
                const formData = new FormData(this);
                const formObj = {};
                formData.forEach((value, key) => { formObj[key] = value; });

                const contactData = {
                    nombre: formObj.nombre || '',
                    email: formObj.email || '',
                    telefono: formObj.telefono || '',
                    empresa: formObj.empresa || '',
                    servicio: formObj.servicio || '',
                    presupuesto: formObj.presupuesto || '',
                    mensaje: formObj.mensaje || '',
                    fechaEnvio: firebase.firestore.Timestamp.now(),
                    estado: 'nuevo',
                    userAgent: navigator.userAgent,
                    timestamp: new Date().toISOString()
                };

                await db.collection('contactos').add(contactData);
                
                successMessage.style.display = 'block';
                this.reset();
                
                document.querySelectorAll('.valid, .invalid').forEach(field => {
                    field.classList.remove('valid', 'invalid');
                });

                setTimeout(() => { successMessage.style.display = 'none'; }, 5000);

            } catch (error) {
                console.error('Error al enviar formulario:', error);
                errorMessage.textContent = 'Error al enviar el formulario: ' + error.message;
                errorMessage.style.display = 'block';
            } finally {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });
    });
  </script>

</body>
</html>
